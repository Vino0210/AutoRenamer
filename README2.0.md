# 文件自动重命名（AutoRename）

一个简洁的 Windows 桌面工具：根据文件**修改时间**自动添加日期前缀（`YYYYMMDD_`），并提供 **Diff 预览、过滤器、冲突自动序号、撤销上一次（Undo）** 等功能，帮助你安全、快速地批量整理文件命名。

---

## 功能概览

- **按修改时间添加日期前缀**：`YYYYMMDD_原文件名`
- **改名预览（Diff）**：右侧表格展示“原文件名 → 新文件名”，支持筛选
  - 只看有变化的
  - 只看冲突的
  - 搜索过滤
- **过滤器**（可选）：按扩展名 / 包含关键词 / 排除关键词筛选需要处理的文件
- **冲突策略（自动序号）**：当目标文件名已存在，自动追加 `_001/_002/...`（插入在扩展名前）
- **撤销上一次（Undo）**：可将最近一次实际改名操作恢复到原文件名
- **拖拽导入**：支持将文件夹/文件拖入工具
- **递归子文件夹**：可选包含子目录
- **仅预览（Dry-run）**：不真正改名，只生成预览（不会写入撤销历史）

---

## 使用方式

### 1）选择目标
- 点击左侧 **选择文件夹 / 选择文件**  
或  
- 直接把文件夹/文件拖拽到左侧区域

### 2）设置选项（可选）
- ✅ 包含子文件夹：递归处理所有子目录
- ✅ 仅预览（不真正重命名）：只看 Diff 预览，不会修改文件名

### 3）过滤器（可选）
- **扩展名**：如 `skp, skb, jpg, png`（逗号或空格分隔）
- **包含关键词**：文件名必须包含（不区分大小写）
- **排除关键词**：文件名包含即跳过（不区分大小写）

> 不填写过滤器 = 不过滤，会扫描目录内所有文件（但仍会根据规则自动跳过不需要改的）。

### 4）查看右侧 Diff 预览
确认无误后点击左下角 **开始处理**。

---

## 规则说明

### 命名规则
- 以文件**修改时间（mtime）**生成日期前缀：`YYYYMMDD_`
- 新文件名格式：`YYYYMMDD_原文件名`

### 跳过规则
- 若文件名已以 `YYYYMMDD_` 开头，会 **跳过**（避免重复加前缀）
- 若生成的新文件名已存在：
  - 启用冲突策略：自动生成 `xxx_001.ext / xxx_002.ext ...`

---

## 撤销（Undo）说明

- **撤销上一次**：可恢复最近一次“真实执行的改名”
- **仅预览（Dry-run）** 不会写入撤销历史，因此无法撤销
- 撤销过程中若出现以下情况，会跳过并记录日志：
  - 文件被移动/删除
  - 旧文件名已被其他文件占用（为避免覆盖，默认跳过）

> 撤销历史会保存在用户目录下（不依赖 exe 所在目录权限）。

---

